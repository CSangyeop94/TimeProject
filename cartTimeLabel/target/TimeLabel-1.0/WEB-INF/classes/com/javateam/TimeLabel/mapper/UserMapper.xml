<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.javateam.TimeLabel.mapper.UserMapper">

	<resultMap type="com.javateam.TimeLabel.model.UserVO" id="UserVOResultMap">
		<result property="userIndex" column="USER_INDEX" />
		<result property="userId" column="USER_ID" />
		<result property="userPw" column="USER_PW" />
		<result property="userName" column="USER_NAME" />
		<result property="userEmail" column="USER_EMAIL" />
		<result property="userContact" column="USER_MOBILE" />
		<result property="userZip" column="USER_ZIP" />
		<result property="userAddress" column="USER_ADDRESS" />
		<result property="userAddressDetail" column="USER_ADDRESS_DETAIL" />
	</resultMap>
	
	<!-- include -->
	<sql id="search" >
		USER_INDEX, USER_ID, USER_PW, USER_NAME, USER_MOBILE, USER_EMAIL, USER_ZIP, USER_ADDRESS, USER_ADDRESS_DETAIL
	</sql>

	<!-- 업데이트 용 -->
	<sql id="updateUser">
		USER_NAME=#{updateParam.userName},
		USER_PW=#{updateParam.userPw},
		USER_MOBILE=#{updateParam.userContact},
		USER_EMAIL=#{updateParam.userEmail},
		USER_ADDRESS=#{updateParam.userAddress},
		USER_ADDRESS_DETAIL=#{updateParam.userAddressDetail}
	</sql>

	<insert id="userJoin" parameterType="com.javateam.TimeLabel.model.UserVO" useGeneratedKeys="true">

		insert into USER (USER_ID, USER_PW, USER_NAME, USER_EMAIL, USER_MOBILE, USER_ZIP, USER_ADDRESS, USER_ADDRESS_DETAIL)
		values(#{userId}, #{userPw}, #{userName}, #{userEmail}, #{userContact}, #{userZip}, #{userAddress}, #{userAddressDetail})

	</insert>

	<!-- 조회 -->
	<select id="findUser" resultType="com.javateam.TimeLabel.model.UserVO" parameterType="Long">
		select
		<include refid="search"></include>
		from USER
		where USER_INDEX=#{userIndex}
	</select>

	<!-- 전체 조회 -->
	<select id="findAllUser" resultType="com.javateam.TimeLabel.model.UserVO">
		select
		<include refid="search"></include>
		from USER
	</select>

	<!-- 업데이트 -->
	<update id="updateUser">
		update USER
		set
		<include refid="updateUser"></include>
		where USER_INDEX=#{userIndex}
	</update>

	<!-- 삭제 -->
	<delete id="deleteUser">
		delete from USER where USER_INDEX=#{userIndex}
	</delete>

	<!-- 아이디 중복 검사 -->
	<select id="userIdCheck" resultType="int">
		select
			count(*)
		from USER
		where USER_ID = #{userId}
	</select>

	<!-- 로그인 -->
	<select id="userLogin" resultType="com.javateam.TimeLabel.model.UserVO">
		select 
		<include refid="search"></include>
		from USER
		where USER_ID = #{userId} and USER_PW = #{userPw}
	</select>


</mapper>